Formulaire d'inscription École de Tennis
Artéfact interactif ∙ Version 31 
Maintenant, il faut aussi modifier légèrement votre script Google Apps Script pour qu'il fonctionne correctement. Le problème est que votre script utilise JSON.parse(e.postData.contents) mais les données arrivent sous forme de formulaire standard.

Voici le script corrigé pour votre Google Apps Script :

javascript
function doPost(e) {
  try {
    console.log('Données reçues:', e);
    
    // Récupérer la feuille active
    const sheet = SpreadsheetApp.getActiveSheet();

    // Récupérer les données soit depuis JSON soit depuis les paramètres
    let data;
    if (e.postData && e.postData.contents) {
      try {
        data = JSON.parse(e.postData.contents);
      } catch (jsonError) {
        // Si le JSON parsing échoue, utiliser les paramètres
        data = e.parameter;
      }
    } else {
      data = e.parameter;
    }

    console.log('Données parsées:', data);

    // Si c'est la première ligne, créer les en-têtes
    if (sheet.getLastRow() === 0) {
      const headers = [
        'Date inscription',
        'Nom',
        'Prénom',
        'Date de naissance',
        'Adresse',
        'Code postal et ville',
        'Téléphone',
        'Niveau tennis',
        'Email',
        'Baby Tennis',
        'Mini Tennis',
        'Initiation',
        'Perfectionnement Tennis',
        'Centre Entraînement',
        'Cours Adultes Tennis',
        'Perfectionnement Padel',
        'Cours Adultes Padel',
        'Formule Mixte',
        'Formule Demi-journée',
        'Disponibilités Mercredi',
        'Disponibilités Samedi',
        'Disponibilités Semaine',
        'Licence FFT'
      ];
      sheet.getRange(1, 1, 1, headers.length).setValues([headers]);

      // Mettre en forme les en-têtes
      sheet.getRange(1, 1, 1, headers.length)
        .setBackground('#4285f4')
        .setFontColor('#ffffff')
        .setFontWeight('bold');
    }

    // Préparer les données pour l'insertion
    const rowData = [
      data.dateInscription || new Date().toLocaleDateString('fr-FR'),
      data.nom || '',
      data.prenom || '',
      data.dateNaissance || '',
      data.adresse || '',
      data.codePostalVille || '',
      data.telPort || '',
      data.niveauTennis || '',
      data.mail || '',
      data.babyTennis === 'Oui' ? 'Oui' : 'Non',
      data.miniTennis === 'Oui' ? 'Oui' : 'Non',
      data.initiation === 'Oui' ? 'Oui' : 'Non',
      data.perfectionnementTennis === 'Oui' ? 'Oui' : 'Non',
      data.centreEntrainement === 'Oui' ? 'Oui' : 'Non',
      data.coursAdultesTennis === 'Oui' ? 'Oui' : 'Non',
      data.perfectionnementPadel === 'Oui' ? 'Oui' : 'Non',
      data.coursAdultesPadel === 'Oui' ? 'Oui' : 'Non',
      data.formuleMixte === 'Oui' ? 'Oui' : 'Non',
      data.formuleDemiJournee === 'Oui' ? 'Oui' : 'Non',
      data.dispMercredi || '',
      data.dispSamedi || '',
      data.dispSemaine || '',
      data.licenceFFT || 'Non'
    ];

    // Ajouter la nouvelle ligne
    sheet.appendRow(rowData);
    console.log('Ligne ajoutée:', rowData);

    // Retourner une réponse de succès
    return ContentService
      .createTextOutput(JSON.stringify({
        'result': 'success',
        'row': sheet.getLastRow()
      }))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    console.error('Erreur dans doPost:', error);
    // En cas d'erreur, retourner l'erreur
    return ContentService
      .createTextOutput(JSON.stringify({
        'result': 'error',
        'error': error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
